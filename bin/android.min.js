function show_large_image(a){var b=has_elt_class(a,"offline");b&&(del_elt_class(a,"thumb"),del_elt_class(a,"offline")),add_elt_class(a,"loading");var c=null,d=a.querySelectorAll("img");if(d.length>0&&(c=d[0]),c){var e=null;if(d.length>1&&(e=d[1]),e)return;0==c.naturalWidth&&a.removeChild(c)}var f=(a.getAttribute("ss_index"),a.getAttribute("s_height"),a.getAttribute("s_width"),a.getAttribute("src_path")),g=f,h=document.createElement("div");h.innerHTML="<img onload='appendimg.call(this)' style='display:none' onerror='errorimg.call(this)' src='"+g+"' alt_src='"+g+"' width='1' height='1'/>";var i=h.firstElementChild;if(h.removeChild(i),a.appendChild(i),!b){var j=document.createElement("i");j.className="spinner",a.appendChild(j)}unbind_loadOriginImg_trigger(a)}function loadOriginImg_handler(a){var b=this;setTimeout(function(){show_large_image(b)},100),a.preventDefault()}function bind_loadOriginImg_trigger(a){a.addEventListener("click",loadOriginImg_handler,!1)}function unbind_loadOriginImg_trigger(a){a.removeEventListener("click",loadOriginImg_handler,!1)}function image_load_cb(a,b,c){if(!(0>a||a>=imgs.length)){var d=imgs[a],e=d.querySelectorAll("img"),f=null;if(e.length>0&&(f=e[0]),f){var g=null;e.length>1&&(g=e[1]);var h=d.getAttribute("src_path"),i=d.getAttribute("thumb_path");if(g){if(c)if(b){var j=h;g.setAttribute("src",j)}else d.removeChild(g);else if(b){var j=i;f.setAttribute("src",j)}}else{var j=h;b?f.setAttribute("src",j):del_elt_class(d,"loading")}}}}function appendimg(){var a=this.parentNode,b=a.getAttribute("s_width"),c=a.getAttribute("s_height"),d=a.getAttribute("t_width"),e=a.getAttribute("t_height"),f=this.naturalWidth,g=this.naturalHeight,h=this.width,i=this.height,j=!1;if(h==b&&i==c)j=!0,this.getAttribute("width")!=b&&(a.style.width=b+"px",a.style.height=c+"px"),del_elt_class(a,"thumb"),del_elt_class(a,"offline"),unbind_loadOriginImg_trigger(a);else if(f>0&&g>0){var k=article.offsetWidth,l=adjust_origin_scale_big(f,g,k);a.style.width=l.w+"px",a.style.height=l.h+"px",h==d&&i==e&&(a.style.width=d+"px",a.style.height=e+"px")}else a.style.width="120px",a.style.height="120px";j||""==this.src&&bind_loadOriginImg_trigger(a),this.style.display="block";var m=a.firstElementChild;m&&"IMG"==m.tagName&&m!=this&&a.removeChild(m);var n=a.querySelector(".spinner");n&&n.parentNode.removeChild(n),del_elt_class(a,"loading")}function errorimg(){var a=this.parentNode;"none"==img_type?(add_elt_class(a,"offline"),bind_loadOriginImg_trigger(a)):del_elt_class(a,"offline"),del_elt_class(a,"loading")}function adjust_origin_scale_big(a,b,c){a||(a=200);var d=c,e=0;return d||(d=200),e=parseInt(b*d/a),e||(e=200),{w:d,h:e}}function adjust_origin_scale_small(a,b,c){var d=.25*c;a||(a=200);var e=a,f=0;return e=d>e?e:d,e||(e=200),f=parseInt(b*e/a),f||(f=200),{w:e,h:f}}function recalImgSize(){var a=article.offsetWidth,b=imgs.length;for(i=0;i<b;i++){var c=imgs[i],d=c.getAttribute("height"),e=c.getAttribute("width"),f=adjust_origin_scale_big(e,d,a),g=c.getAttribute("height"),h=c.getAttribute("width"),j=adjust_origin_scale_small(h,g,a);c.setAttribute("s_width",f.w),c.setAttribute("s_height",f.h),c.setAttribute("t_width",j.w),c.setAttribute("t_height",j.h),c.setAttribute("ss_index",i)}}function show_images(a){var b=["origin","thumb","none"];if(-1!=b.indexOf(a)){imgs_len=imgs.length;for(var c=0;c<imgs_len;c++){var d=imgs[c],e=d.getAttribute("s_height"),f=d.getAttribute("s_width"),g=d.getAttribute("src_path"),h=d.getAttribute("thumb_path"),i="",j=g;del_elt_class(d,"offline"),add_elt_class(d,"loading"),"thumb"==a&&(j=h,add_elt_class(d,"thumb"),e=d.getAttribute("t_height"),f=d.getAttribute("t_width"),bind_loadOriginImg_trigger(d)),"none"==a&&(j=i),d.style.width=f+"px",d.style.height=e+"px",close_lazyload?d.innerHTML="<img onload='appendimg.call(this)' style='display:none' onerror='errorimg.call(this)' src='"+j+"' width='"+f+"' height='"+e+"'/>":(d.setAttribute("lazy_src",j),d.setAttribute("lazy_w",f),d.setAttribute("lazy_h",e))}}}function showImages(){recalImgSize(),show_images(img_type)}function toggle_images(){show_images("origin"),close_lazyload||(clicked_toggle_img_btn=!0,init_lazyload(),_pollImages(),document.addEventListener("scroll",_pollImages,!1))}function init_lazyload(){store=[];for(var a=document.querySelectorAll("[lazy_src]"),b=a.length,c=0;b>c;c++)store.push(a[c])}function _pollImages(){var a=store.length;if(a>0)for(var b=0;a>b;b++){var c=store[b];if(c&&_inView(c)){var d=c.getAttribute("lazy_w"),e=c.getAttribute("lazy_h"),f=c.getAttribute("lazy_src"),g=document.createElement("div");g.innerHTML="<img onload='appendimg.call(this)' style='display:none' onerror='errorimg.call(this)' src='"+f+"' width='"+d+"' height='"+e+"'/>";var h=g.firstElementChild;g.removeChild(h),c.appendChild(h),c.removeAttribute("lazy_src"),store.splice(b,1),a=store.length,b--}}else document.removeEventListener("scroll",_pollImages,!1)}function _inView(a){var b=a.getBoundingClientRect();return b.top<0?!0:(b.top>=0&&b.left>=0&&b.top)<=(window.innerHeight||document.body.clientHeight)+offset}function initVars(){article=document.getElementsByTagName("article")[0],imgs=document.getElementsByClassName("image"),metas=document.getElementsByTagName("meta");for(var a=imgs.length,b=0,c=metas.length;c>b;b++){var d=metas[b],e=d.name.toLowerCase(),f=d.getAttribute("content");switch(e){case"load_image":img_type=f}}if(close_lazyload&&a>10&&(close_lazyload=!1),"origin"!=img_type){var g=imgs[0];if(g){var h=document.querySelector(".toggle-img-con");if(h){g.parentNode.insertBefore(h,g);var i=document.getElementById("toggle-img");i.style.display="inline-block",i.addEventListener("click",function(a){i.style.display="none",setTimeout(function(){toggle_images()},100)},!1)}}}}function initPage(){initVars(),clearTimeout(the_timeout),the_timeout=setTimeout(function(){showImages(),close_lazyload||(init_lazyload(),_pollImages(),document.addEventListener("scroll",_pollImages,!1))},1e3)}function add_elt_class(a,b){if(!a||!b)return!1;try{var c=a.getAttribute("class");null==c&&(c="");for(var d=!1,e=c.split(" "),f=0;f<e.length;f++)if(e[f]==b){d=!0;break}if(!d)return c.length>0?c=c.concat(" ",b):(b.indexOf(" ")>-1&&(c=b.trim()),c=b),a.setAttribute("class",c),!0}catch(g){}return!1}function del_elt_class(a,b){if(!a||!b)return!1;try{var c=a.getAttribute("class");if(null==c)return!1;var d=!1,e=c.split(" ");c="";for(var f=0;f<e.length;f++)e[f]!=b?c=c.concat(" ",e[f]):d=!0;if(d)return c.indexOf(" ")>-1&&(c=c.trim()),a.setAttribute("class",c),!0}catch(g){}return!1}function has_elt_class(a,b){if(!a||!b)return!1;try{var c=a.getAttribute("class");if(null==c)return!1;for(var d=c.split(" "),e=0;e<d.length;e++)if(d[e]==b)return!0}catch(f){}return!1}"undefined"==typeof close_lazyload&&(close_lazyload=!1);var img_type="origin",imgs=[],article,store=[],offset=100,clicked_toggle_img_btn=!1,the_timeout=setTimeout(function(){},1e4);